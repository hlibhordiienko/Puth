Sub СоздатьСписокФайлов()
    Dim ПутьКПапке As String
    Dim Файл As String
    Dim СтрокаСписка As Long
    
    ' Укажите путь к папке
    ПутьКПапке = "Путь\к\вашей\папке\"
    
    ' Укажите номер строки, с которой начнется список файлов в текущем листе
    СтрокаСписка = 1
    
    ' Очищаем предыдущий список, если есть
    Cells(СтрокаСписка, 1).CurrentRegion.ClearContents
    
    ' Перебираем файлы в папке
    Файл = Dir(ПутьКПапке & "*.*")
    
    Do While Файл <> ""
        ' Выводим название файла в ячейку
        Cells(СтрокаСписка, 1).Value = Файл
        
        ' Переходим к следующей строке списка
        СтрокаСписка = СтрокаСписка + 1
        
        ' Переходим к следующему файлу
        Файл = Dir
    Loop
End Sub